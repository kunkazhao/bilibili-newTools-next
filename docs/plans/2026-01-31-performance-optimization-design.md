# 选品库 / 蓝链映射 / 评论蓝链 管理页面性能优化方案（A+B）

日期：2026-01-31

## 目标与体验（面向用户）
- 进入页面后 1 秒内看到“页面框架 + 关键控件”（侧栏、筛选、按钮）。
- 列表区域立即出现骨架屏，占位不空白。
- 商品/蓝链列表分段加载，滚动不明显卡顿。
- 编辑/删除等操作只更新当前卡片，避免整页重刷。
- 图片与长文本延迟加载，先保证文字和操作可用。

## 范围
- 选品库（Archive）
- 蓝链商品映射（Blue Link Map）
- 评论蓝链管理（Comment Blue Link）

## 非目标
- 不改动现有接口协议和数据结构。
- 不新增搜索防抖（按需求明确不加）。
- 不追求“极限性能”，优先“体感速度”。

## 总体策略（A + B 组合）

### A. 低成本首屏提速
- 先渲染“框架 + 骨架”，列表内容延后。
- 分类/统计/筛选栏优先渲染，列表可稍后填充。
- 图片进入视口再加载（懒加载）。
- 列表数据本地缓存，先展示缓存，再后台刷新。

### B. 分区加载 + 分段渲染
- 分类/统计/列表并行请求，互不阻塞。
- 列表按 50/100 条分段加载（支持“加载更多”或滚动加载）。
- 只渲染可见区域（虚拟滚动或分批渲染）。
- 编辑/删除后只更新当前卡片，不刷新整列表。

## 页面级落地方案

### 1) 选品库（Archive）
- 首屏顺序：分类栏 + 统计/筛选栏 -> 列表骨架 -> 列表数据。
- 列表分段加载（50/100 一段），滚动追加。
- 商品图片懒加载，列表首屏优先文字。
- 编辑/删除/匹配参数后只更新单卡片。
- 列表容器固定高度（滚动区域稳定），避免页面整体重排。

### 2) 蓝链商品映射（Blue Link Map）
- 左侧账号/分类先渲染，右侧列表延后。
- 右侧卡片分段加载（50/100 一段）。
- 搜索/筛选只刷新卡片列表，不影响左侧。
- 卡片内图片与超长内容懒加载。
- “选择商品/编辑蓝链”弹窗打开前优先使用缓存列表，后台静默更新。

### 3) 评论蓝链管理（Comment Blue Link）
- 左侧账号先出，右侧组合列表骨架。
- 长文案默认折叠，点击展开才渲染全文。
- 列表分段加载，避免一次渲染大段文本。
- 编辑/删除只更新当前组合卡片。

## 数据与缓存策略
- 本地缓存：最近一次列表数据 + 当前筛选条件。
- 进入页面优先读缓存，后台拉最新数据，差异合并。
- 分区缓存：分类/账号/列表分开缓存，避免互相阻塞。

## 视觉与交互统一
- 骨架屏样式统一（与已有 Skeleton 组件一致）。
- 列表为空时显示 Empty，占位清晰。
- 加载更多按钮与滚动加载二选一，避免混乱。

## 验证方式
- 记录“页面框架出现时间”“首段列表渲染时间”。
- 500+ 列表数据压力测试，滚动观察掉帧。
- 编辑/删除操作不触发整页重绘。

## 风险与规避
- 风险：分段加载与排序/筛选耦合。
  - 规避：先完成筛选，再分段加载。
- 风险：骨架屏闪烁。
  - 规避：设置最短展示时长（例如 300ms）。

## 落地顺序建议
1. 选品库（列表多、收益最大）
2. 蓝链映射（列表长、图片多）
3. 评论蓝链（文本长、渲染重）

## 需确认的细节（实现前可选）
- 列表每段加载条数（50 / 100）
- 虚拟滚动 vs 分批渲染（优先分批，后续可升级虚拟）
- 是否保留“加载更多”按钮（若保留则不启用自动滚动加载）
